<simulation mode='md' verbosity='high'>
    <output prefix='simulation'>
        <properties stride='1' filename='pot'>  [ pot_component_raw(0), pot_component_raw(1) ] </properties>
        <properties stride='1' filename='out'>  [ step, time{picosecond}, conserved, temperature{kelvin}, kinetic_cv, potential, pressure_cv{megapascal} ] </properties>
        <trajectory stride='1' filename='pos'>  positions{angstrom} </trajectory>
        <checkpoint stride='1'/>
    </output>
    <total_steps> 100 </total_steps>
    <prng>
        <seed>31415</seed>
    </prng>
    <ffsocket name='lmp_short' mode='unix'>
        <address>h2o-pimd+mts.1_short</address>
    </ffsocket>
    <ffsocket name='lmp_long' mode='unix'>
        <address>h2o-pimd+mts.1</address>
    </ffsocket>
    <system>
        <initialize nbeads='1'>
            <file mode='pdb'> init.pdb </file>
            <velocities mode='thermal' units='kelvin'> 300 </velocities>
        </initialize>
        <forces>
            <!--
             MTS setup - apply the fast (short-range) force in the inner loop and the slow (long-range) force in the outer loop.
             Note that if the outer loop contains a *correction* to the inner loop the weights should be
             [-1,1] (fast force) and [1,0] (slow force)
             -->
            <force forcefield='lmp_short'>
                <mts_weights>[-1,1]</mts_weights>
            </force>
            <force forcefield='lmp_long'>
                <mts_weights>[ 1,0]</mts_weights>
            </force>
        </forces>
        <motion mode='constrained_dynamics'>
            <constrained_dynamics mode='nve' splitting='respa'>
                <!--nsteps_geo> [1,1] </nsteps_geo-->
                <csolver mode='sparse'>
                    <maxit> 10000 </maxit>
                    <norm_order> 2 </norm_order>
                    <tolerance> .0001 </tolerance>
                </csolver>
                <nmts> [1, 4] </nmts>
                <timestep units='femtosecond'> 8.0 </timestep>
                <thermostat mode='langevin'>
                    <tau units='femtosecond'> 5 </tau>
                </thermostat>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[0,1,2]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[0,1,0,2]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[3,4,5]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[3,4,3,5]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[6,7,8]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[6,7,6,8]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[9,10,11]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[9,10,9,11]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[12,13,14]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[12,13,12,14]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[15,16,17]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[15,16,15,17]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[18,19,20]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[18,19,18,20]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[21,22,23]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[21,22,21,23]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[24,25,26]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[24,25,24,26]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[27,28,29]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[27,28,27,29]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[30,31,32]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[30,31,30,32]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[33,34,35]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[33,34,33,35]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[36,37,38]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[36,37,36,38]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[39,40,41]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[39,40,39,41]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[42,43,44]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[42,43,42,44]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[45,46,47]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[45,46,45,47]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[48,49,50]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[48,49,48,50]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[51,52,53]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[51,52,51,53]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[54,55,56]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[54,55,54,56]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[57,58,59]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[57,58,57,59]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[60,61,62]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[60,61,60,62]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[63,64,65]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[63,64,63,65]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[66,67,68]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[66,67,66,68]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[69,70,71]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[69,70,69,71]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[72,73,74]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[72,73,72,74]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[75,76,77]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[75,76,75,77]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[78,79,80]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[78,79,78,80]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[81,82,83]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[81,82,81,83]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[84,85,86]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[84,85,84,86]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[87,88,89]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[87,88,87,89]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[90,91,92]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[90,91,90,92]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
    <constraint mode="multi">
        <constraint mode="angle">
             <atoms>[93,94,95]</atoms>
             <values units="degree">[104.75]</values>
        </constraint>
        <constraint mode="distance">
             <atoms>[93,94,93,95]</atoms>
             <values units="angstrom">[0.96,0.96]</values>
        </constraint>
    </constraint>
            </constrained_dynamics>
        </motion>
        <ensemble>
            <temperature units='kelvin'> 300 </temperature>
        </ensemble>
    </system>
</simulation>

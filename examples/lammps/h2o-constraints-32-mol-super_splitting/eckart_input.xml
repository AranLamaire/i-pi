<simulation mode='md' verbosity='high'>
    <output prefix='simulation'>
        <properties stride='1' filename='pot'>  [ pot_component_raw(0), pot_component_raw(1) ] </properties>
        <properties stride='1' filename='out'>  [ step, time{picosecond}, conserved, temperature{kelvin}, kinetic_cv, potential, pressure_cv{megapascal} ] </properties>
        <trajectory stride='1' filename='pos'>  positions{angstrom} </trajectory>
        <checkpoint stride='10'/>
    </output>
    <total_steps> 100 </total_steps>
    <prng>
        <seed>31415</seed>
    </prng>
    <ffsocket name='lmp_short' mode='unix'>
        <address>h2o-pimd+mts.1_short</address>
    </ffsocket>
    <ffsocket name='lmp_long' mode='unix'>
        <address>h2o-pimd+mts.1</address>
    </ffsocket>
    <system>
        <initialize nbeads='1'>
            <file mode='pdb'> init.pdb </file>
            <velocities mode='thermal' units='kelvin'> 300 </velocities>
        </initialize>
        <forces>
            <!--
             MTS setup - apply the fast (short-range) force in the inner loop and the slow (long-range) force in the outer loop.
             Note that if the outer loop contains a *correction* to the inner loop the weights should be
             [-1,1] (fast force) and [1,0] (slow force)
             -->
            <force forcefield='lmp_short'>
                <mts_weights>[-1,1]</mts_weights>
            </force>
            <force forcefield='lmp_long'>
                <mts_weights>[ 1,0]</mts_weights>
            </force>
        </forces>
        <motion mode='constrained_dynamics'>
            <constrained_dynamics mode='nve' splitting='respa'>
                <!--nsteps_geo> [1,1] </nsteps_geo-->
                <csolver mode='sparse'>
                    <maxit> 10000 </maxit>
                    <norm_order> 2 </norm_order>
                    <tolerance> .0001 </tolerance>
                </csolver>
                <nmts> [1, 4] </nmts>
                <timestep units='femtosecond'> 0.25 </timestep>
                <thermostat mode='langevin'>
                    <tau units='femtosecond'> 5 </tau>
                </thermostat>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[0,1,2]</atoms>
                     <values units="angstrom">
                         [ 3.8372566, 4.6989987,-0.6743520,
                           4.5443361, 4.3348202,-0.6591143,
                           3.9434185, 5.3120083,-1.4823316]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[3,4,5]</atoms>
                     <values units="angstrom">
                         [ 9.9437723, 8.7495864, 0.3423988,
                           10.0584378, 8.2114198, 1.1103144,
                           9.2985614, 8.3490846,-0.3094305]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[6,7,8]</atoms>
                     <values units="angstrom">
                         [ 0.2781739, 1.4390207, 5.7831780,
                          -0.3326250, 1.9655533, 5.3248701,
                           0.8690018, 2.1465995, 6.4248848]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[9,10,11]</atoms>
                     <values units="angstrom">
                         [-2.1805879,-0.4541683, 4.2392218,
                          -3.0040636,-0.4960209, 4.8322081,
                          -1.5993528,-0.9754454, 4.8620404]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[12,13,14]</atoms>
                     <values units="angstrom">
                         [-4.5063171,-1.0984645, 11.0137306,
                          -3.9002158,-0.6091493, 11.0768534,
                          -5.1124067,-1.2672533, 11.8620475]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[15,16,17]</atoms>
                     <values units="angstrom">
                         [-2.1854277, 0.1239553, 11.5607710,
                          -2.0302529,-0.0571781, 12.4176318,
                          -1.2829825,-0.0679243, 10.9922016]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[18,19,20]</atoms>
                     <values units="angstrom">
                         [ 8.1813899, 4.1093010, 0.7765578,
                           7.7978632, 5.0514448, 0.9263880,
                           7.7794691, 3.5630492, 1.4029249]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[21,22,23]</atoms>
                     <values units="angstrom">
                         [-3.8296746, 3.2515744,-0.4902983,
                          -3.0502534, 3.4593364,-0.0182594,
                          -3.6790496, 2.4109471,-0.9772213]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[24,25,26]</atoms>
                     <values units="angstrom">
                         [ 10.3619053,-2.5077793, 2.7732540,
                           10.1867114,-2.0576056, 3.5683428,
                           10.5138049,-3.4160936, 2.8717601]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[27,28,29]</atoms>
                     <values units="angstrom">
                         [ 4.9591315, 2.5216964, 6.1637751,
                           5.6117971, 3.2688070, 6.2000824,
                           5.2912880, 2.0979251, 6.9466614]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[30,31,32]</atoms>
                     <values units="angstrom">
                         [-3.1803677, 2.4780680, 2.3956603,
                          -3.9710175, 2.3976094, 2.6774120,
                          -2.8376122, 1.7102295, 2.1233087]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[33,34,35]</atoms>
                     <values units="angstrom">
                         [ 3.2956295,-1.2499027, 3.1820205,
                           2.8172177,-1.8553727, 2.7601782,
                           2.6983146,-0.5408660, 3.3989637]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[36,37,38]</atoms>
                     <values units="angstrom">
                         [ 1.5736648, 1.4938892, 0.7418145,
                           0.9999392, 0.4814623, 0.5620509,
                           1.6507137, 1.5367088, 1.8662431]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[39,40,41]</atoms>
                     <values units="angstrom">
                         [ 1.3078760, 4.9445283, 3.2935400,
                           2.2080823, 4.6065841, 3.4547983,
                           1.3277979, 4.9562407, 2.2060216]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[42,43,44]</atoms>
                     <values units="angstrom">
                         [-3.4922105, 6.4396111, 4.4275223,
                          -3.1864429, 5.6978548, 5.0852053,
                          -3.4214194, 7.3607223, 5.0601515]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[45,46,47]</atoms>
                     <values units="angstrom">
                         [-0.9877256, 3.4067258, 4.3822256,
                          -0.3309370, 3.8904837, 3.9410159,
                          -1.6603550, 3.0606388, 4.0176098]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[48,49,50]</atoms>
                     <values units="angstrom">
                         [-2.7318705, 4.6355923, 6.3163201,
                          -2.6429857, 4.3887415, 7.2682328,
                          -1.9353238, 4.0397832, 5.9335676]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[51,52,53]</atoms>
                     <values units="angstrom">
                         [ 0.4205411, 5.6727283, 8.2175864,
                           0.5398657, 4.7667757, 7.8364699,
                           0.7318793, 5.6859582, 9.1959242]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[54,55,56]</atoms>
                     <values units="angstrom">
                         [ 10.9107588, 4.1572066, 0.5117174,
                           11.3582678, 3.2198348, 0.5732387,
                           9.9563055, 3.9022403, 0.4244829]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[57,58,59]</atoms>
                     <values units="angstrom">
                         [ 4.1618987, 2.5980204, 3.5339851,
                           4.7290011, 2.4327995, 4.3679979,
                           4.3111984, 3.5244813, 3.4127235]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[60,61,62]</atoms>
                     <values units="angstrom">
                         [ 14.0345131, 5.3645181, 3.6418980,
                           13.8945500, 5.6305882, 2.7790312,
                           14.7325058, 5.8849282, 3.8528446]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[63,64,65]</atoms>
                     <values units="angstrom">
                         [ 0.3230835, 8.6147235, 5.1073363,
                           0.1756797, 9.4169840, 5.5174012,
                           0.8126263, 8.1274519, 5.7948876]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[66,67,68]</atoms>
                     <values units="angstrom">
                         [ 6.0399116, 10.5051611, 8.1617012,
                           6.7342684, 9.9196671, 8.6421196,
                           5.1941814, 10.3115455, 8.5589347]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[69,70,71]</atoms>
                     <values units="angstrom">
                         [ 7.3031603, 8.0566151, 9.1112482,
                           6.7070596, 7.7546631, 8.3917851,
                           6.7933679, 7.8487666, 9.8556271]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[72,73,74]</atoms>
                     <values units="angstrom">
                         [ 2.0250553, 1.0816525, 3.5518325,
                           1.5632191, 1.3023434, 4.5454665,
                           2.7544079, 1.5235390, 3.6312534]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[75,76,77]</atoms>
                     <values units="angstrom">
                         [ 7.6471104, 6.6702005, 2.2278132,
                           7.1225942, 6.5528728, 2.9124716,
                           8.5629463, 6.6295105, 2.4631976]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[78,79,80]</atoms>
                     <values units="angstrom">
                         [ 2.8012806, 7.4692381, 7.2150568,
                           2.3177575, 8.0633195, 7.6746630,
                           2.3124249, 6.6301709, 7.4459170]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[81,82,83]</atoms>
                     <values units="angstrom">
                         [ 2.3073879, 13.0497647, 7.3936434,
                           2.6338806, 13.5489155, 8.0818170,
                           2.9976308, 12.9123477, 6.6602233]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[84,85,86]</atoms>
                     <values units="angstrom">
                         [ 3.6982749, 9.9297357, 9.2604065,
                           4.1908979, 9.4597124, 9.9366116,
                           3.1317559, 10.6568505, 9.7455021]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[87,88,89]</atoms>
                     <values units="angstrom">
                         [ 5.1649700, 6.7765441, 7.6416934,
                           4.2398115, 7.1572685, 7.6289358,
                           5.5202862, 7.1407117, 6.7747204]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[90,91,92]</atoms>
                     <values units="angstrom">
                         [ 3.5560254, 6.6352652, 1.0942010,
                           4.1617384, 7.4012597, 0.6149207,
                           3.6015816, 5.9330117, 0.4561061]
                    </values>
                </constraint>
            </constraint>
            <constraint mode="multi">
                <constraint mode="eckart">
                     <atoms>[93,94,95]</atoms>
                     <values units="angstrom">
                         [ 5.4909819, 9.2338505, 5.9296990,
                           5.4198255, 9.5534342, 6.8167024,
                           4.5572855, 9.3081180, 5.5464373]
                    </values>
                </constraint>
            </constraint>
            </constrained_dynamics>
        </motion>
        <ensemble>
            <temperature units='kelvin'> 300 </temperature>
        </ensemble>
    </system>
</simulation>

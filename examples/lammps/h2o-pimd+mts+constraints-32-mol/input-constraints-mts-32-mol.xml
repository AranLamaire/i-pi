<simulation mode='md' verbosity='high'>
  <output prefix='simulation'>
    <properties stride='1' filename='out'>  [ step, time{picosecond}, conserved, temperature{kelvin}, kinetic_cv, potential, pressure_cv{megapascal} ] </properties>
    <trajectory filename='pos' stride='1'> positions </trajectory>
    <checkpoint stride='200'/>
  </output>
  <total_steps>2000</total_steps>
  <prng>
    <seed>31415</seed>
  </prng>
  <ffsocket name='lmp_short' mode='unix'>
    <address>h2o-pimd+mts.4_short</address>
  </ffsocket>
  <ffsocket name='lmp_long' mode='unix'>
    <address>h2o-pimd+mts.4_long</address>
  </ffsocket>
  <system>
    <initialize nbeads='1'>
      <file mode='pdb'> init.pdb </file>
      <velocities mode='thermal' units='kelvin'> 300 </velocities>
    </initialize>
    <forces>
       <!--
         MTS setup - apply the fast (short-range) force in the inner loop and the slow (long-range) force in the outer loop. 
         Note that if the outer loop contains a *correction* to the inner loop the weights should be 
         [-1,1] (fast force) and [1,0] (slow force)
       -->
      <force forcefield='lmp_short'>
        <mts_weights>[0,1]</mts_weights>
      </force>
      <force forcefield='lmp_long'>
        <mts_weights>[1,0]</mts_weights>
      </force>
    </forces>
    <motion mode='constrained_dynamics'>
        <constrained_dynamics mode='nve' splitting='grespa'>
            <nsteps_geo> [1,2] </nsteps_geo>
            <tolerance> .0001 </tolerance>
            <maxit> 10000 </maxit>
            <norm_order> 2 </norm_order>
            <timestep units='femtosecond'> 2.0 </timestep>
            <thermostat mode='langevin'>
                <tau units='femtosecond'> 100 </tau>
            </thermostat>
            <nmts> [1,4] </nmts>
            <constraint mode="distance">
                <atoms> [ 0,  1,  0,  2,  3,  4,  3,  5,  6,  7,  6,  8,  9, 10,  9, 11, 12, 13, 12, 14, 15, 16, 15, 17, 18, 19, 18, 20, 21, 22, 21, 23, 24, 25, 24, 26, 27, 28, 27, 29, 30, 31, 30, 32, 33, 34, 33, 35, 36, 37, 36, 38, 39, 40, 39, 41, 42, 43, 42, 44, 45, 46, 45, 47, 48, 49, 48, 50, 51, 52, 51, 53, 54, 55, 54, 56, 57, 58, 57, 59, 60, 61, 60, 62, 63, 64, 63, 65, 66, 67, 66, 68, 69, 70, 69, 71, 72, 73, 72, 74, 75, 76, 75, 77, 78, 79, 78, 80, 81, 82, 81, 83, 84, 85, 84, 86, 87, 88, 87, 89, 90, 91, 90, 92, 93, 94, 93, 95]
                </atoms>
                <distances> [1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973, 1.88973]  </distances>
            </constraint>
        </constrained_dynamics>
    </motion>
    <ensemble>
      <temperature units='kelvin'> 300 </temperature>
    </ensemble>
  </system>
</simulation>

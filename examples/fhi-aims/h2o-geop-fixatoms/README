# 27.06.2019

Geometry optimization test: 1 water molecule in vacuum
with different numbers of freezed atoms.

To launch a geometry optmization test for a certain optimizer, type 
./run-all-tests.sh <mode>, 
where mode is bfgs, bfgstrm, cg or sd.

resulting files are 
aims.[0-3]-fixed.<mode>.out
log.[0-3]-fixed.<mode>.ipi
sim-[0-3]-fixed.<mode>.pos_0.xyz

0-3 means the number of atoms fixed in a water molecule.
    0 and 1 are expected to give the same energy, 
    2 should give the different energy, 
    3 should throw warning "all atoms are fixed" and do nothing.

'ase-comparison' folder shows that BFGS gives the same result in both codes.

'count-ipi-force-calls.sh' allows to compare performance (and also check for 
the old bug with forces called twice per geop step)


RESULTS:
All optimizers pass this test successfully and give the same energies and structures (wrt defined tolerances).
But CG and SD have HUGE problems with convergence. It is unrelated to fixatoms.

#       Energy-0-fixed  Energy-1-fixed  Energy-2-fixed  Force calls total   aims (re)initializations
BFGS      -2078.496560    -2078.496543    -2078.446832                 35                         38
BFGSTRM   -2078.496559    -2078.496542    -2078.446833                 40                         43
CG        -2078.496558    -2078.496549    -2078.446834                479                        482
SD        -2078.496556    -2078.496546    -2078.446615               1196                       1199 (I stopped at this point)